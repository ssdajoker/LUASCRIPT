
> LUASCRIPT@1.0.0-phase1d test
> node test/test_transpiler.js && node tests/test_arrow_functions.js && node tests/test_memory_management.js

ğŸ¯ Running Phase 1B Critical Runtime Compatibility Tests


ğŸ§ª Testing: String Concatenation (+ to ..)
ğŸ“ JavaScript Input:
let message = "Hello" + " " + "World";
console.log(message);

ğŸ”„ Transpiled Lua:
-- LUASCRIPT Runtime Library Integration
local runtime = require('runtime.runtime')
local console = runtime.console
local JSON = runtime.JSON
local Math = runtime.Math

local message = "Hello" .. " " .. "World";
console.log(message);
âœ… Pattern found: "local message = "Hello" .. " " .. "World""
âœ… Pattern found: "console.log(message)"
ğŸš€ Execution Output:
Hello World

âœ… Test "String Concatenation (+ to ..)" PASSED

ğŸ§ª Testing: Logical Operators (|| to or, && to and)
ğŸ“ JavaScript Input:
let result = true || false;
let result2 = true && false;
console.log(result, result2);

ğŸ”„ Transpiled Lua:
-- LUASCRIPT Runtime Library Integration
local runtime = require('runtime.runtime')
local console = runtime.console
local JSON = runtime.JSON
local Math = runtime.Math

local result = true or false;
local result2 = true and false;
console.log(result, result2);
âœ… Pattern found: "true or false"
âœ… Pattern found: "true and false"
âœ… Pattern found: "console.log(result, result2)"
ğŸš€ Execution Output:
true false

âœ… Test "Logical Operators (|| to or, && to and)" PASSED

ğŸ§ª Testing: Equality Operators (=== to ==, !== to ~=)
ğŸ“ JavaScript Input:
let isEqual = (5 === 5);
let isNotEqual = (5 !== 3);
console.log(isEqual, isNotEqual);

ğŸ”„ Transpiled Lua:
-- LUASCRIPT Runtime Library Integration
local runtime = require('runtime.runtime')
local console = runtime.console
local JSON = runtime.JSON
local Math = runtime.Math

local isEqual = (5 == 5);
local isNotEqual = (5 ~= 3);
console.log(isEqual, isNotEqual);
âœ… Pattern found: "5 == 5"
âœ… Pattern found: "5 ~= 3"
âœ… Pattern found: "console.log(isEqual, isNotEqual)"
ğŸš€ Execution Output:
true true

âœ… Test "Equality Operators (=== to ==, !== to ~=)" PASSED

ğŸ§ª Testing: Runtime Library Integration (console.log)
ğŸ“ JavaScript Input:
console.log("Testing console.log");
console.error("Testing console.error");
console.warn("Testing console.warn");

ğŸ”„ Transpiled Lua:
-- LUASCRIPT Runtime Library Integration
local runtime = require('runtime.runtime')
local console = runtime.console
local JSON = runtime.JSON
local Math = runtime.Math

console.log("Testing console.log");
console.error("Testing console.error");
console.warn("Testing console.warn");
âœ… Pattern found: "require('runtime.runtime')"
âœ… Pattern found: "local console = runtime.console"
âœ… Pattern found: "console.log("Testing console.log")"
âœ… Pattern found: "console.error("Testing console.error")"
âœ… Pattern found: "console.warn("Testing console.warn")"
ERROR: WARNING: ğŸš€ Execution Output:
Testing console.log
Testing console.error
Testing console.warn

âœ… Test "Runtime Library Integration (console.log)" PASSED

ğŸ§ª Testing: Complex Expression (Multiple Fixes)
ğŸ“ JavaScript Input:
let name = "John";
let age = 25;
let message = "Name: " + name + ", Age: " + age;
let isAdult = age >= 18 && name !== "";
console.log(message);
console.log("Is adult:", isAdult);

ğŸ”„ Transpiled Lua:
-- LUASCRIPT Runtime Library Integration
local runtime = require('runtime.runtime')
local console = runtime.console
local JSON = runtime.JSON
local Math = runtime.Math

local name = "John";
local age = 25;
local message = "Name = " .. name .. ", Age = " .. age;
local isAdult = age >= 18 and name ~= "";
console.log(message);
console.log("Is adult:", isAdult);
âœ… Pattern found: ""Name = " .. name .. ", Age = " .. age"
âœ… Pattern found: "age >= 18 and name ~= """
âœ… Pattern found: "console.log(message)"
âœ… Pattern found: "console.log("Is adult:", isAdult)"
ğŸš€ Execution Output:
Name = John, Age = 25
Is adult: true

âœ… Test "Complex Expression (Multiple Fixes)" PASSED

ğŸ§ª Testing: Function with String Operations
ğŸ“ JavaScript Input:
function greet(name) {
    let greeting = "Hello, " + name + "!";
    console.log(greeting);
    return greeting;
}
greet("World");

ğŸ”„ Transpiled Lua:
-- LUASCRIPT Runtime Library Integration
local runtime = require('runtime.runtime')
local console = runtime.console
local JSON = runtime.JSON
local Math = runtime.Math

local function greet(name)
    local greeting = "Hello, " .. name .. "!";
    console.log(greeting);
    return greeting;
end
greet("World");
âœ… Pattern found: "local function greet(name)"
âœ… Pattern found: ""Hello, " .. name .. "!""
âœ… Pattern found: "console.log(greeting)"
âœ… Pattern found: "greet("World")"
ğŸš€ Execution Output:
Hello, World!

âœ… Test "Function with String Operations" PASSED

ğŸ“Š TEST REPORT
==================================================
Total Tests: 6
Passed: 6
Failed: 0
Success Rate: 100.0%

ğŸ¯ Phase 1B Critical Fixes Status:
  âœ… PASS String Concatenation (+ to ..)
  âœ… PASS Logical Operators (|| to or, && to and)
  âœ… PASS Equality Operators (=== to ==, !== to ~=)
  âœ… PASS Runtime Library Integration (console.log)

==================================================
ğŸ‰ ALL PHASE 1B TESTS PASSED!
âœ… Critical runtime compatibility fixes are working correctly.
Running Arrow Functions Test Suite...

âœ… Parse simple arrow function
âœ… Parse arrow function with parentheses
âœ… Parse arrow function with multiple parameters
âœ… Parse arrow function with block body
âœ… Execute simple arrow function
âœ… Execute arrow function with multiple parameters
âœ… Execute arrow function with block body
âœ… Arrow function closure test
âœ… Memory manager limits node allocation
âœ… Memory manager limits recursion depth
âœ… Memory manager cleanup works
GC: Freed 0 bytes, heap size now 0 bytes
âœ… Runtime memory management prevents stack overflow
âœ… Invalid arrow function syntax throws error
âœ… Arrow function with invalid parameter throws error
âœ… Arrow functions work with built-in functions
âœ… Complex arrow function expression

Test Results: 16 passed, 0 failed
Running Memory Management Test Suite...

âœ… MemoryManager initializes with correct defaults
âœ… MemoryManager allocates nodes correctly
âœ… MemoryManager enforces node limit
âœ… MemoryManager tracks scope depth
âœ… MemoryManager enforces depth limit
âœ… MemoryManager cleanup works
âœ… MemoryManager provides accurate stats
âœ… RuntimeMemoryManager initializes correctly
âœ… RuntimeMemoryManager tracks function calls
âœ… RuntimeMemoryManager enforces call stack limit
âœ… RuntimeMemoryManager tracks heap allocation
GC: Freed 27.000000000000007 bytes, heap size now 62.99999999999999 bytes
GC: Freed 18.9 bytes, heap size now 44.099999999999994 bytes
âœ… RuntimeMemoryManager enforces heap limit
GC: Freed 255 bytes, heap size now 595 bytes
âœ… RuntimeMemoryManager triggers garbage collection
GC: Freed 0 bytes, heap size now 0 bytes
âœ… RuntimeMemoryManager cleanup works
âœ… RuntimeMemoryManager provides accurate stats
âœ… Parser with memory limits handles complex code
GC: Freed 0 bytes, heap size now 0 bytes
âœ… Runtime with memory limits prevents infinite recursion
GC: Freed 0 bytes, heap size now 0 bytes
âœ… Memory stats are accessible during execution

Test Results: 18 passed, 0 failed
